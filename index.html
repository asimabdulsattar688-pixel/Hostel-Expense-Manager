<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Hostel Expense App</title>
<link rel="manifest" href="manifest.json">
<style>
body{font-family:Arial, sans-serif; padding:10px}
table{width:100%; border-collapse:collapse}
th,td{border:1px solid #ccc; padding:6px; text-align:center}
.green{color:green; font-weight:bold}
.red{color:red; font-weight:bold}
button{margin:4px}
input,select{margin:4px}
.box{border:1px solid #ddd; padding:8px; margin-bottom:10px}
</style>
</head>
<body>

<h2>Hostel Expense Manager</h2>

<div class="box">
<h3>Members</h3>
<input id="memberName" placeholder="Member name">
<button onclick="addMember()">Add</button>
<ul id="members"></ul>
</div>

<div class="box">
<h3>Add Entry</h3>
<select id="type">
  <option value="expense">Expense</option>
  <option value="collection">Collection</option>
</select>
<input id="amount" type="number" placeholder="Amount">
<input id="desc" placeholder="Description (e.g. Rice, Electricity)">

<h4>Who was included?</h4>
<div id="memberChecks"></div>

<button onclick="addEntry()">Add</button>
</div>

<div class="box">
<h3>Records</h3>
<table>
<thead>
<tr>
<th>Date</th>
<th>Type</th>
<th>Amount</th>
<th>Description</th>
<th>Included Members</th>
</tr>
</thead>
<tbody id="records"></tbody>
</table>
</div>

<script>
let data = JSON.parse(localStorage.getItem("data")) || {members:[], records:[]};

function save(){
  localStorage.setItem("data", JSON.stringify(data));
  render();
}

function addMember(){
  let n=document.getElementById("memberName").value;
  if(!n) return;
  data.members.push(n);
  document.getElementById("memberName").value="";
  save();
}

function addEntry(){
  let amt=document.getElementById("amount").value;
  let type=document.getElementById("type").value;
  let desc=document.getElementById("desc").value;
  if(!amt) return;

  let included=[];
  document.querySelectorAll(".memcheck").forEach(c=>{
    if(c.checked) included.push(c.value);
  });

  let date = new Date().toLocaleString();

  data.records.push({
    type:type,
    amt:amt,
    desc:desc || "-",
    date:date,
    included:included
  });

  document.getElementById("amount").value="";
  document.getElementById("desc").value="";
  save();
}

function render(){
  let m=document.getElementById("members");
  m.innerHTML="";
  data.members.forEach(x=>m.innerHTML+=`<li>${x}</li>`);

  let checks=document.getElementById("memberChecks");
  checks.innerHTML="";
  data.members.forEach(x=>{
    checks.innerHTML+=`<label><input type="checkbox" class="memcheck" value="${x}" checked> ${x}</label><br>`;
  });

  let r=document.getElementById("records");
  r.innerHTML="";
  data.records.forEach(x=>{
    r.innerHTML+=`
    <tr>
      <td>${x.date}</td>
      <td class="${x.type=='expense'?'red':'green'}">${x.type}</td>
      <td>${x.amt}</td>
      <td>${x.desc}</td>
      <td>${x.included.join(", ")}</td>
    </tr>`;
  });
}
render();
</script>

</body>
</html>
